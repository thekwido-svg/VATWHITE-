<!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <title>VATWHITE - ADMIN REAL-TIME</title>
    <style>
        body { background: #111; color: white; font-family: sans-serif; padding: 20px; }
        .card { background: #222; padding: 15px; margin-bottom: 20px; border-left: 5px solid #facc15; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 10px; border: 1px solid #333; text-align: left; }
        th { background: #facc15; color: #000; }
        .btn-pay { background: #22c55e; color: white; padding: 5px; cursor: pointer; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>VATWHITE - Usimamizi wa Biashara</h1>
    
    <div class="card">
        <h3>Maombi ya Kutoa Pesa (Withdraw Requests)</h3>
        <table id="withdrawTable">
            <thead>
                <tr>
                    <th>Jina Kamili</th>
                    <th>Namba ya MPESA</th>
                    <th>Kiasi (KES)</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>

    <div class="card">
        <h3>Wachezaji Waliojisajili (Registered Users)</h3>
        <table id="usersTable">
            <thead>
                <tr>
                    <th>Jina</th>
                    <th>Namba ya Simu</th>
                    <th>Salio la Kweli (KES)</th>
                    <th>Ongeza Salio</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>

    <script>
        async function loadData() {
            // Hii itachukua data ya kweli kutoka kwenye server yako
            const res = await fetch('/admin/data');
            const data = await res.json();
            
            // Jaza meza ya Withdraw
            const wTable = document.querySelector("#withdrawTable tbody");
            wTable.innerHTML = data.withdraws.map(w => `
                <tr>
                    <td>${w.name}</td>
                    <td>${w.phone}</td>
                    <td>${w.amount}</td>
                    <td><button class="btn-pay" onclick="markPaid('${w.phone}')">Nimemlipa</button></td>
                </tr>
            `).join('');

            // Jaza meza ya Wachezaji
            const uTable = document.querySelector("#usersTable tbody");
            uTable.innerHTML = data.users.map(u => `
                <tr>
                    <td>${u.name}</td>
                    <td>${u.phone}</td>
                    <td>${u.balance}</td>
                    <td><input type="number" id="amt-${u.phone}"><button onclick="topUp('${u.phone}')">OK</button></td>
                </tr>
            `).join('');
        }
        setInterval(loadData, 5000); // Inajifunua kila baada ya sekunde 5
    </script>
</body>
</html>
