<!DOCTYPE html>
<html>
<body style="background:#000; color:white; font-family:sans-serif; padding:20px;">
    <h2>VATWHITE ADMIN</h2>
    <table border="1" style="width:100%; text-align:left;">
        <thead>
            <tr><th>Jina</th><th>Simu</th><th>Salio</th><th>Action</th></tr>
        </thead>
        <tbody id="list"></tbody>
    </table>

<script>
    async function load() {
        const res = await fetch('/admin/users');
        const users = await res.json();
        document.getElementById('list').innerHTML = users.map(u => `
            <tr>
                <td>${u.name}</td>
                <td>${u.phone}</td>
                <td style="color:yellow">${u.balance}</td>
                <td>
                    <button onclick="upd('${u.phone}','add')" style="background:green; color:white;">+ PESA</button>
                    <button onclick="upd('${u.phone}','sub')" style="background:red; color:white;">- PESA</button>
                </td>
            </tr>
        `).join('');
    }
    async function upd(phone, action) {
        const amt = prompt("Kiasi:");
        if(amt) {
            await fetch('/admin/update-balance', { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({phone, amount:amt, action}) });
            load();
        }
    }
    setInterval(load, 3000);
</script>
</body>
</html>
