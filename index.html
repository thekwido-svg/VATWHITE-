<!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VATWHITE - Aviator</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; color: white; font-family: 'Roboto', sans-serif; overflow: hidden; }
        .header { display: flex; justify-content: space-between; padding: 10px; background: #1b1b1b; border-bottom: 2px solid #333; align-items: center; }
        .balance { color: #28a745; font-weight: bold; font-size: 18px; }
        .dep-btn { background: #28a745; color: white; border: none; padding: 8px 15px; border-radius: 5px; font-weight: bold; }
        
        /* Game Screen Area */
        #game-view { width: 95%; height: 35vh; margin: 10px auto; background: radial-gradient(circle, #2c3e50, #000); border-radius: 15px; position: relative; overflow: hidden; display: flex; align-items: center; justify-content: center; }
        .multiplier { font-size: 60px; font-weight: bold; z-index: 10; color: white; }
        .plane { position: absolute; width: 60px; left: 10%; bottom: 10%; transition: all 0.1s linear; }

        /* Betting Controls */
        .controls-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 10px; }
        .bet-card { background: #1b1b1b; padding: 10px; border-radius: 10px; border: 1px solid #333; text-align: center; }
        .amount-input { width: 80%; background: #000; border: 1px solid #444; color: white; padding: 10px; border-radius: 5px; margin-bottom: 10px; font-size: 18px; }
        .btn-main { width: 100%; padding: 15px; border: none; border-radius: 10px; font-size: 20px; font-weight: bold; cursor: pointer; }
        .btn-bet { background: #28a745; color: white; }
        .btn-cashout { background: #ffc107; color: black; display: none; }

        /* Login Screen */
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .login-box { width: 85%; background: #1b1b1b; padding: 20px; border-radius: 15px; text-align: center; }
        input { width: 90%; padding: 12px; margin: 10px 0; border-radius: 5px; border: none; background: #333; color: white; }
    </style>
</head>
<body>

<div id="login-overlay">
    <div class="login-box">
        <h2 style="color:#d40000">VATWHITE</h2>
        <input type="text" id="user-phone" placeholder="Namba ya Simu">
        <input type="password" id="user-pass" placeholder="Password">
        <button class="btn-main btn-bet" onclick="attemptLogin()">INGIA / JISAJILI</button>
        <p id="error-msg" style="color:red; font-size:12px; display:none;">Jaribu tena, namba au password imekataa.</p>
    </div>
</div>

<div class="header">
    <span id="player-name">User</span>
    <div class="balance"><span id="user-balance">0.00</span> KES</div>
    <button class="dep-btn">Deposit</button>
</div>

<div id="game-view">
    <div class="multiplier" id="main-mult">1.00x</div>
    <img src="https://i.ibb.co/V99n9vM/rocket.png" class="plane" id="plane-img">
</div>

<div class="controls-container">
    <div class="bet-card">
        <input type="number" class="amount-input" value="10.00">
        <button class="btn-main btn-bet" id="bet-btn-1">BET</button>
    </div>
    <div class="bet-card">
        <input type="number" class="amount-input" value="10.00">
        <button class="btn-main btn-bet" id="bet-btn-2">BET</button>
    </div>
</div>

<script>
    let userData = null;

    // Kazi ya kuingia (Login)
    async function attemptLogin() {
        const phone = document.getElementById('user-phone').value;
        const pass = document.getElementById('user-pass').value;

        if(!phone || !pass) return alert("Jaza zote!");

        try {
            const response = await fetch('/api/login', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ phone, pass })
            });
            
            const data = await response.json();
            if(data.success) {
                userData = data.user;
                localStorage.setItem('v_user', JSON.stringify(userData));
                document.getElementById('login-overlay').style.display = 'none';
                updatePlayerInfo();
            } else {
                document.getElementById('error-msg').style.display = 'block';
            }
        } catch(e) {
            alert("Server haipatikani. Hakikisha Render iko Live!");
        }
    }

    function updatePlayerInfo() {
        document.getElementById('player-name').innerText = userData.name;
        document.getElementById('user-balance').innerText = parseFloat(userData.balance).toFixed(2);
    }

    // Ndege kupaa (Animation)
    let m = 1.00;
    setInterval(() => {
        m += 0.01;
        document.getElementById('main-mult').innerText = m.toFixed(2) + "x";
        let p = document.getElementById('plane-img');
        p.style.left = (10 + (m * 2)) + "%";
        p.style.bottom = (10 + (m * 3)) + "%";
        if(m > 10) m = 1.00; // Reset kwa ajili ya demo
    }, 100);
</script>
</body>
</html>
